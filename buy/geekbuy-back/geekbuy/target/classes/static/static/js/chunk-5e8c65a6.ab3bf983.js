(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e8c65a6"],{"27c1":function(e,t,s){},2810:function(e,t,s){"use strict";s("b06c")},"4fc4":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-container"},[t("div",{staticClass:"main-content"},[e._t("default")],2)])},r=[],n={name:"PageBody"},i=n,o=(s("c95a"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"7617c039",null);t["a"]=d.exports},"6e70":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header"},[t("div",{staticClass:"header-container"},[t("div",{staticClass:"app-name"},[t("router-link",{attrs:{to:"/"}},[t("b",{staticStyle:{color:"#333"}},[e._v("GeekBuy")])])],1),t("div",{staticClass:"search-container"},[t("el-input",{attrs:{placeholder:"欢迎来到GeekBuy，即刻买！"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchIdle.apply(null,arguments)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchIdle},slot:"append"})],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-s-tools"},on:{click:e.tool}},[e._v("工具")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.toRelease}},[e._v("即刻发布")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-chat-dot-round"},on:{click:e.toMessage}},[e._v("消息")]),e.isLogin?t("el-dropdown",{attrs:{trigger:"click"}},[t("div",{staticStyle:{cursor:"pointer",display:"flex","align-items":"center"}},[t("div",{staticStyle:{"font-size":"16px",color:"#666","padding-right":"5px"}},[e._v(e._s(e.nicknameValue?e.nicknameValue:e.nickname))]),t("el-avatar",{attrs:{src:e.avatarValue?e.avatarValue:e.avatar}})],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("div",{on:{click:e.toMe}},[e._v("个人中心")])]),t("el-dropdown-item",{staticStyle:{color:"red"},attrs:{divided:""}},[t("div",{on:{click:e.loginOut}},[e._v("退出登录")])])],1)],1):t("router-link",{staticClass:"user-name-text",attrs:{to:"/login"}},[e._v("登录")])],1)])},r=[],n=(s("a481"),{name:"Header",props:["searchInput","nicknameValue","avatarValue"],data:function(){return{searchValue:this.searchInput,nickname:"登录",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",isLogin:!1}},created:function(){var e=this;this.$globalData.userInfo.nickname?(this.nickname=this.$globalData.userInfo.nickname,this.avatar=this.$globalData.userInfo.avatar,this.isLogin=!0):this.$api.getUserInfo().then((function(t){console.log("Header getUserInfo:",t),1===t.status_code&&(e.nickname=t.data.nickname,e.avatar=t.data.avatar,t.data.signInTime=t.data.signInTime.substring(0,10),e.$globalData.userInfo=t.data,e.isLogin=!0)}))},methods:{searchIdle:function(){"/search"!==this.$route.path?this.$router.push({path:"/search",query:{searchValue:this.searchValue}}):(this.$router.replace({path:"/search",query:{searchValue:this.searchValue}}),this.$router.go(0))},toMe:function(){"/me"!==this.$route.path&&this.$router.push({path:"/me"})},toMessage:function(){"/message"!==this.$route.path&&this.$router.push({path:"/message"})},toRelease:function(){"/release"!==this.$route.path&&this.$router.push({path:"/release"})},tool:function(){"/tool"!==this.$route.path&&this.$router.push({path:"/tool"})},loginOut:function(){var e=this;this.$api.logout().then((function(t){1===t.status_code?(e.$globalData.userInfo={},console.log("login out"),"/index"===e.$route.path?e.$router.go(0):e.$router.push({path:"/index"})):e.$message.error("网络或系统异常，退出登录失败！")}))}}}),i=n,o=(s("2810"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"164415d3",null);t["a"]=d.exports},"7c83":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("app-head"),t("app-body",[t("div",{staticClass:"order-page-container"},[t("div",{staticClass:"idle-info-container",on:{click:function(t){return e.toDetails(e.orderInfo.idleItem.id)}}},[t("el-image",{staticStyle:{width:"150px",height:"150px"},attrs:{src:e.orderInfo.idleItem.imgUrl,fit:"cover"}}),t("div",{staticClass:"idle-info-title"},[e._v(e._s(e.orderInfo.userId==e.userId?"买到的":"卖出的")+"："+e._s(e.orderInfo.idleItem.idleName))]),t("div",{staticClass:"idle-info-price"},[e._v("￥"+e._s(e.orderInfo.orderPrice))])],1),t("div",{staticClass:"address-container",style:e.orderInfo.userId==e.userId&&0===e.orderInfo.orderStatus?"cursor: pointer;":"",on:{click:function(t){return t.stopPropagation(),e.selectAddressDialog.apply(null,arguments)}}},[t("div",{staticClass:"address-title"},[e._v("收货地址: "+e._s(e.addressInfo.consigneeName)+" "+e._s(e.addressInfo.consigneePhone))]),t("div",{staticClass:"address-detials"},[e._v(e._s(e.addressInfo.detailAddress))]),e.addressInfo.detailAddress?e._e():t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.selectAddressDialog.apply(null,arguments)}}},[e._v("选择收货地址")])],1),t("el-dialog",{attrs:{title:"选择地址",visible:e.addressDialogVisible,width:"800px"},on:{"update:visible":function(t){e.addressDialogVisible=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"无地址信息，请先在个人中心添加地址",data:e.addressData}},[t("el-table-column",{attrs:{prop:"consigneeName",label:"收货人姓名",width:"120"}}),t("el-table-column",{attrs:{prop:"consigneePhone",label:"手机号",width:"140"}}),t("el-table-column",{attrs:{prop:"detailAddressText",label:"地址"}}),t("el-table-column",{attrs:{label:" ",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.selectAddress(s.$index,s.row)}}},[e._v("选择\n                            ")])]}}])})],1)],1),t("div",{staticClass:"order-info-container"},[t("div",{staticClass:"order-info-title"},[e._v("订单信息（"+e._s(e.orderStatus[e.orderInfo.orderStatus])+"）：")]),t("div",{staticClass:"order-info-item"},[e._v("编号："+e._s(e.orderInfo.orderNumber))]),t("div",{staticClass:"order-info-item"},[e._v("支付状态："+e._s(0===e.orderInfo.paymentStatus?"未支付":"已支付"))]),t("div",{staticClass:"order-info-item"},[e._v("支付方式："+e._s(e.orderInfo.paymentWay))]),t("div",{staticClass:"order-info-item"},[e._v("创建时间："+e._s(e.orderInfo.createTime.substring(0,10)+" "+e.orderInfo.createTime.substring(11,19))+"\n                ")]),t("div",{staticClass:"order-info-item"},[e._v("支付时间："+e._s(e.orderInfo.paymentTime?e.orderInfo.paymentTime.substring(0,10)+" "+e.orderInfo.paymentTime.substring(11,19):"")+"\n                ")])]),t("div",{staticClass:"menu"},[e.userId==e.orderInfo.userId&&0===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){return e.changeOrderStatus(4,e.orderInfo)}}},[e._v("取消订单")]):e._e(),e.userId==e.orderInfo.userId&&0===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(1,e.orderInfo)}}},[e._v("立即支付")]):e._e(),e.userId==e.orderInfo.idleItem.userId&&1===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(2,e.orderInfo)}}},[e._v("发货")]):e._e(),e.userId==e.orderInfo.userId&&2===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(3,e.orderInfo)}}},[e._v("确认收货")]):e._e()],1)],1),t("app-foot")],1)],1)},r=[],n=(s("a481"),s("28a5"),s("6e70")),i=s("4fc4"),o=s("85a9"),d={name:"order",components:{AppHead:n["a"],AppBody:i["a"],AppFoot:o["a"]},data:function(){return{addressDialogVisible:!1,addressData:[],orderStatus:["待付款","待发货","待收货","已完成","已取消"],orderInfo:{createTime:"",id:0,idleId:0,idleItem:{id:"",idleName:"",idleDetails:"",pictureList:[],idlePrice:0,idlePlace:"",idleLabel:"",idleStatus:-1,userId:""},orderNumber:"",orderPrice:0,orderStatus:0,paymentStatus:0,paymentTime:"",paymentWay:"",userId:0},addressInfo:{id:"",update:!1,consigneeName:"",consigneePhone:"",detailAddress:""},userId:""}},created:function(){var e=this;this.userId=this.getCookie("shUserId"),console.log("userId",this.userId,this.getCookie("shUserId"));var t=this.$route.query.id;console.log(t),this.$api.getOrder({id:t}).then((function(t){if(console.log(t),1===t.status_code){if(t.data.idleItem){var s=JSON.parse(t.data.idleItem.pictureList);s.length>0?t.data.idleItem.imgUrl=s[0]:t.data.idleItem.imgUrl=""}else t.data.idleItem={idleName:"",imgUrl:""};e.orderInfo=t.data,e.$api.getOrderAddress({orderId:e.orderInfo.id}).then((function(t){t.data?(e.addressInfo=t.data,e.addressInfo.update=!0):e.getAddressData()}))}}))},methods:{getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){var r=s[a].trim();if(0===r.indexOf(t))return r.substring(t.length,r.length)}return"0"},toDetails:function(e){this.$router.replace({path:"details",query:{id:e}})},selectAddressDialog:function(){this.orderInfo.userId==this.userId&&0===this.orderInfo.orderStatus&&(this.addressDialogVisible=!0,0===this.addressData.length&&this.getAddressData())},getAddressData:function(){var e=this;this.$api.getAddress().then((function(t){if(1===t.status_code){for(var s=t.data,a=0;a<s.length;a++)s[a].detailAddressText=s[a].provinceName+s[a].cityName+s[a].regionName+s[a].detailAddress;if(console.log(s),e.addressData=s,!e.addressInfo.update)for(var r=0;r<s.length;r++)s[r].defaultFlag&&e.selectAddress(r,s[r])}}))},selectAddress:function(e,t){var s=this;this.addressDialogVisible=!1,console.log(t,this.addressInfo),this.addressInfo.consigneeName=t.consigneeName,this.addressInfo.consigneePhone=t.consigneePhone,this.addressInfo.detailAddress=t.detailAddressText,this.addressInfo.update?this.$api.updateOrderAddress({id:this.addressInfo.id,consigneeName:t.consigneeName,consigneePhone:t.consigneePhone,detailAddress:t.detailAddressText}):this.$api.addOrderAddress({orderId:this.orderInfo.id,consigneeName:t.consigneeName,consigneePhone:t.consigneePhone,detailAddress:t.detailAddressText}).then((function(e){1===e.status_code?(s.addressInfo.update=!0,s.addressInfo.id=e.data.id):s.$message.error(e.msg)}))},changeOrderStatus:function(e,t){var s=this;1===e?(console.log("zhifu"),this.addressInfo.detailAddress?this.$confirm("返回的是支付宝支付","支付订单",{confirmButtonText:"支付",cancelButtonText:"取消",type:"warning"}).then((function(){s.$api.updateOrder({id:t.id,orderStatus:e,paymentStatus:1,paymentWay:"支付宝"}).then((function(t){1===t.status_code&&(s.$message({message:"支付成功！",type:"success"}),s.orderInfo.orderStatus=e,s.orderInfo.paymentStatus=1,s.orderInfo.paymentWay="支付宝",s.orderInfo.paymentTime=t.data.paymentTime)}))})).catch((function(){})):this.$message.error("请选择地址！")):this.$api.updateOrder({id:t.id,orderStatus:e}).then((function(t){1===t.status_code&&(s.$message({message:"操作成功！",type:"success"}),s.orderInfo.orderStatus=e)}))}}},l=d,c=(s("8a3b"),s("2877")),u=Object(c["a"])(l,a,r,!1,null,"763a1948",null);t["default"]=u.exports},"85a9":function(e,t,s){"use strict";var a=function(){var e=this;e._self._c;return e._m(0)},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"foot-container"},[t("div",{staticClass:"author"},[e._v("© 2023 GeekBuy. All Rights Reserved.")])])}],n={name:"Foot"},i=n,o=(s("a747"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"17569e24",null);t["a"]=d.exports},"8a3b":function(e,t,s){"use strict";s("27c1")},a747:function(e,t,s){"use strict";s("f027")},b06c:function(e,t,s){},c95a:function(e,t,s){"use strict";s("ff1e")},f027:function(e,t,s){},ff1e:function(e,t,s){}}]);